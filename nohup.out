data loaded.
--------------------------------------------------
Decision Tree
model trained.
evaluating test
Accuracy: 0.5219021568190895
Classification Report:
              precision    recall  f1-score   support

         0.0       0.86      0.44      0.58    214417
         1.0       0.31      0.77      0.44     68546

    accuracy                           0.52    282963
   macro avg       0.58      0.61      0.51    282963
weighted avg       0.73      0.52      0.55    282963

Confusion Matrix:
[[ 94564 119853]
 [ 15431  53115]]
evaluating train
Accuracy: 0.9998975257642791
Classification Report:
              precision    recall  f1-score   support

         0.0       1.00      1.00      1.00    531841
         1.0       1.00      1.00      1.00    531841

    accuracy                           1.00   1063682
   macro avg       1.00      1.00      1.00   1063682
weighted avg       1.00      1.00      1.00   1063682

Confusion Matrix:
[[531841      0]
 [   109 531732]]
evaluated
--------------------------------------------------
--------------------------------------------------
Naive Bayes
model trained.
evaluating test
Accuracy: 0.613104893572658
Classification Report:
              precision    recall  f1-score   support

         0.0       0.85      0.60      0.70    214417
         1.0       0.35      0.67      0.46     68546

    accuracy                           0.61    282963
   macro avg       0.60      0.63      0.58    282963
weighted avg       0.73      0.61      0.64    282963

Confusion Matrix:
[[127723  86694]
 [ 22783  45763]]
evaluating train
Accuracy: 0.6300896320516847
Classification Report:
              precision    recall  f1-score   support

         0.0       0.64      0.59      0.62    531841
         1.0       0.62      0.67      0.64    531841

    accuracy                           0.63   1063682
   macro avg       0.63      0.63      0.63   1063682
weighted avg       0.63      0.63      0.63   1063682

Confusion Matrix:
[[316330 215511]
 [177956 353885]]
evaluated
--------------------------------------------------
--------------------------------------------------
Quadratic Descriminant
model trained.
evaluating test
Accuracy: 0.5684771507228861
Classification Report:
              precision    recall  f1-score   support

         0.0       0.87      0.50      0.64    214417
         1.0       0.33      0.77      0.46     68546

    accuracy                           0.57    282963
   macro avg       0.60      0.64      0.55    282963
weighted avg       0.74      0.57      0.60    282963

Confusion Matrix:
[[107827 106590]
 [ 15515  53031]]
evaluating train
Accuracy: 0.6392361626877205
Classification Report:
              precision    recall  f1-score   support

         0.0       0.69      0.50      0.58    531841
         1.0       0.61      0.77      0.68    531841

    accuracy                           0.64   1063682
   macro avg       0.65      0.64      0.63   1063682
weighted avg       0.65      0.64      0.63   1063682

Confusion Matrix:
[[268445 263396]
 [120342 411499]]
evaluated
--------------------------------------------------
--------------------------------------------------
Extra Trees Classifier
model trained.
evaluating test
Accuracy: 0.5379749295844333
Classification Report:
              precision    recall  f1-score   support

         0.0       0.92      0.43      0.58    214417
         1.0       0.33      0.89      0.48     68546

    accuracy                           0.54    282963
   macro avg       0.63      0.66      0.53    282963
weighted avg       0.78      0.54      0.56    282963

Confusion Matrix:
[[ 91389 123028]
 [  7708  60838]]
evaluating train
Accuracy: 0.9998975257642791
Classification Report:
              precision    recall  f1-score   support

         0.0       1.00      1.00      1.00    531841
         1.0       1.00      1.00      1.00    531841

    accuracy                           1.00   1063682
   macro avg       1.00      1.00      1.00   1063682
weighted avg       1.00      1.00      1.00   1063682

Confusion Matrix:
[[531841      0]
 [   109 531732]]
evaluated
--------------------------------------------------
--------------------------------------------------
Bagging Classifier
model trained.
evaluating test
Accuracy: 0.5579245343030714
Classification Report:
              precision    recall  f1-score   support

         0.0       0.89      0.47      0.62    214417
         1.0       0.33      0.82      0.47     68546

    accuracy                           0.56    282963
   macro avg       0.61      0.65      0.55    282963
weighted avg       0.76      0.56      0.58    282963

Confusion Matrix:
[[101712 112705]
 [ 12386  56160]]
evaluating train
Accuracy: 0.9938976122562947
Classification Report:
              precision    recall  f1-score   support

         0.0       0.99      1.00      0.99    531841
         1.0       1.00      0.99      0.99    531841

    accuracy                           0.99   1063682
   macro avg       0.99      0.99      0.99   1063682
weighted avg       0.99      0.99      0.99   1063682

Confusion Matrix:
[[530078   1763]
 [  4728 527113]]
evaluated
--------------------------------------------------
--------------------------------------------------
Logistic Regression
model trained.
evaluating test
Accuracy: 0.6039906277499179
Classification Report:
              precision    recall  f1-score   support

         0.0       0.87      0.57      0.68    214417
         1.0       0.35      0.72      0.47     68546

    accuracy                           0.60    282963
   macro avg       0.61      0.64      0.58    282963
weighted avg       0.74      0.60      0.63    282963

Confusion Matrix:
[[121263  93154]
 [ 18902  49644]]
evaluating train
Accuracy: 0.6436528962603485
Classification Report:
              precision    recall  f1-score   support

         0.0       0.67      0.56      0.61    531841
         1.0       0.62      0.72      0.67    531841

    accuracy                           0.64   1063682
   macro avg       0.65      0.64      0.64   1063682
weighted avg       0.65      0.64      0.64   1063682

Confusion Matrix:
[[299805 232036]
 [147004 384837]]
evaluated
--------------------------------------------------
--------------------------------------------------
Linear Descriminant
model trained.
evaluating test
Accuracy: 0.6031778006311779
Classification Report:
              precision    recall  f1-score   support

         0.0       0.86      0.57      0.68    214417
         1.0       0.35      0.72      0.47     68546

    accuracy                           0.60    282963
   macro avg       0.60      0.64      0.58    282963
weighted avg       0.74      0.60      0.63    282963

Confusion Matrix:
[[121634  92783]
 [ 19503  49043]]
evaluating train
Accuracy: 0.6395887116638244
Classification Report:
              precision    recall  f1-score   support

         0.0       0.66      0.57      0.61    531841
         1.0       0.62      0.71      0.66    531841

    accuracy                           0.64   1063682
   macro avg       0.64      0.64      0.64   1063682
weighted avg       0.64      0.64      0.64   1063682

Confusion Matrix:
[[300636 231205]
 [152158 379683]]
evaluated
--------------------------------------------------
--------------------------------------------------
Random Forest
model trained.
evaluating test
Accuracy: 0.5495135406395889
Classification Report:
              precision    recall  f1-score   support

         0.0       0.92      0.44      0.60    214417
         1.0       0.34      0.88      0.49     68546

    accuracy                           0.55    282963
   macro avg       0.63      0.66      0.54    282963
weighted avg       0.78      0.55      0.57    282963

Confusion Matrix:
[[ 95310 119107]
 [  8364  60182]]
evaluating train
Accuracy: 0.9998965856336762
Classification Report:
              precision    recall  f1-score   support

         0.0       1.00      1.00      1.00    531841
         1.0       1.00      1.00      1.00    531841

    accuracy                           1.00   1063682
   macro avg       1.00      1.00      1.00   1063682
weighted avg       1.00      1.00      1.00   1063682

Confusion Matrix:
[[531761     80]
 [    30 531811]]
evaluated
--------------------------------------------------
--------------------------------------------------
Adaboost
model trained.
evaluating test
Accuracy: 0.5990465184494086
Classification Report:
              precision    recall  f1-score   support

         0.0       0.89      0.53      0.67    214417
         1.0       0.36      0.80      0.49     68546

    accuracy                           0.60    282963
   macro avg       0.62      0.67      0.58    282963
weighted avg       0.76      0.60      0.63    282963

Confusion Matrix:
[[114453  99964]
 [ 13491  55055]]
evaluating train
Accuracy: 0.6674024755519037
Classification Report:
              precision    recall  f1-score   support

         0.0       0.73      0.53      0.62    531841
         1.0       0.63      0.80      0.71    531841

    accuracy                           0.67   1063682
   macro avg       0.68      0.67      0.66   1063682
weighted avg       0.68      0.67      0.66   1063682

Confusion Matrix:
[[282877 248964]
 [104814 427027]]
evaluated
--------------------------------------------------
--------------------------------------------------
Gradient Boost
model trained.
evaluating test
Accuracy: 0.612868113498938
Classification Report:
              precision    recall  f1-score   support

         0.0       0.90      0.55      0.68    214417
         1.0       0.36      0.80      0.50     68546

    accuracy                           0.61    282963
   macro avg       0.63      0.68      0.59    282963
weighted avg       0.77      0.61      0.64    282963

Confusion Matrix:
[[118672  95745]
 [ 13799  54747]]
evaluating train
Accuracy: 0.689688271494676
Classification Report:
              precision    recall  f1-score   support

         0.0       0.74      0.58      0.65    531841
         1.0       0.66      0.80      0.72    531841

    accuracy                           0.69   1063682
   macro avg       0.70      0.69      0.69   1063682
weighted avg       0.70      0.69      0.69   1063682

Confusion Matrix:
[[309201 222640]
 [107433 424408]]
evaluated
--------------------------------------------------
--------------------------------------------------
XGBoost
/data/covenants/miniconda3/envs/test_cv/lib/python3.13/site-packages/xgboost/training.py:183: UserWarning: [20:17:04] WARNING: /workspace/src/learner.cc:738: 
Parameters: { "use_label_encoder" } are not used.

  bst.update(dtrain, iteration=i, fobj=obj)
model trained.
evaluating test
Accuracy: 0.6194838194392907
Classification Report:
              precision    recall  f1-score   support

         0.0       0.90      0.56      0.69    214417
         1.0       0.37      0.80      0.51     68546

    accuracy                           0.62    282963
   macro avg       0.63      0.68      0.60    282963
weighted avg       0.77      0.62      0.65    282963

Confusion Matrix:
[[120317  94100]
 [ 13572  54974]]
evaluating train
Accuracy: 0.7236251059997255
Classification Report:
              precision    recall  f1-score   support

         0.0       0.77      0.64      0.70    531841
         1.0       0.69      0.81      0.75    531841

    accuracy                           0.72   1063682
   macro avg       0.73      0.72      0.72   1063682
weighted avg       0.73      0.72      0.72   1063682

Confusion Matrix:
[[339728 192113]
 [101862 429979]]
evaluated
--------------------------------------------------
data loaded.
--------------------------------------------------
SGD
model trained.
evaluating test
Accuracy: 0.6076236115675901
Classification Report:
              precision    recall  f1-score   support

         0.0       0.86      0.57      0.69    214417
         1.0       0.35      0.72      0.47     68546

    accuracy                           0.61    282963
   macro avg       0.61      0.65      0.58    282963
weighted avg       0.74      0.61      0.64    282963

Confusion Matrix:
[[122717  91700]
 [ 19328  49218]]
evaluating train
Accuracy: 0.6434554688337304
Classification Report:
              precision    recall  f1-score   support

         0.0       0.67      0.57      0.62    531841
         1.0       0.63      0.72      0.67    531841

    accuracy                           0.64   1063682
   macro avg       0.65      0.64      0.64   1063682
weighted avg       0.65      0.64      0.64   1063682

Confusion Matrix:
[[303237 228604]
 [150646 381195]]
evaluated
--------------------------------------------------
--------------------------------------------------
LightGBM
/data/covenants/miniconda3/envs/test_cv/lib/python3.13/site-packages/sklearn/utils/validation.py:2739: UserWarning: X does not have valid feature names, but LGBMClassifier was fitted with feature names
  warnings.warn(
/data/covenants/miniconda3/envs/test_cv/lib/python3.13/site-packages/sklearn/utils/validation.py:2739: UserWarning: X does not have valid feature names, but LGBMClassifier was fitted with feature names
  warnings.warn(
[LightGBM] [Info] Number of positive: 531841, number of negative: 531841
[LightGBM] [Info] Auto-choosing col-wise multi-threading, the overhead of testing was 0.080665 seconds.
You can set `force_col_wise=true` to remove the overhead.
[LightGBM] [Info] Total Bins 5865
[LightGBM] [Info] Number of data points in the train set: 1063682, number of used features: 23
[LightGBM] [Info] [binary:BoostFromScore]: pavg=0.500000 -> initscore=0.000000
model trained.
evaluating test
Accuracy: 0.6171230867639939
Classification Report:
              precision    recall  f1-score   support

         0.0       0.90      0.56      0.69    214417
         1.0       0.37      0.81      0.51     68546

    accuracy                           0.62    282963
   macro avg       0.63      0.68      0.60    282963
weighted avg       0.77      0.62      0.64    282963

Confusion Matrix:
[[119160  95257]
 [ 13083  55463]]
evaluating train
Accuracy: 0.7154055441381917
Classification Report:
              precision    recall  f1-score   support

         0.0       0.77      0.62      0.69    531841
         1.0       0.68      0.81      0.74    531841

    accuracy                           0.72   1063682
   macro avg       0.72      0.72      0.71   1063682
weighted avg       0.72      0.72      0.71   1063682

Confusion Matrix:
[[330124 201717]
 [101001 430840]]
evaluated
Traceback (most recent call last):
  File "/home/covenants/divya/test/test_mlp/baselines/main.py", line 83, in <module>
    lgbm_train(X_train, X_test, y_train, y_test)
    ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/covenants/divya/test/test_mlp/baselines/light_gbm.py", line 17, in train
    save_shap(X_train, X_test, model, f"plots_shap/{__name__}.png")
    ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/covenants/divya/test/test_mlp/baselines/utils.py", line 77, in save_shap
    explainer = shap.KernelExplainer(predict_func, background_sample_train)
  File "/data/covenants/miniconda3/envs/test_cv/lib/python3.13/site-packages/shap/explainers/_kernel.py", line 95, in __init__
    self.model = convert_to_model(model, keep_index=self.keep_index)
                 ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/covenants/miniconda3/envs/test_cv/lib/python3.13/site-packages/shap/utils/_legacy.py", line 129, in convert_to_model
    out.f.__self__.feature_names_in_ = None
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: property 'feature_names_in_' of 'LGBMClassifier' object has no setter
data loaded.
--------------------------------------------------
Simple MLP
model trained.
evaluating test
Accuracy: 0.6320755717178571
Classification Report:
              precision    recall  f1-score   support

         0.0       0.89      0.59      0.71    214417
         1.0       0.37      0.78      0.51     68546

    accuracy                           0.63    282963
   macro avg       0.63      0.68      0.61    282963
weighted avg       0.77      0.63      0.66    282963

Confusion Matrix:
[[125604  88813]
 [ 15296  53250]]
evaluating train
Accuracy: 0.6842063699489133
Classification Report:
              precision    recall  f1-score   support

         0.0       0.73      0.59      0.65    531841
         1.0       0.66      0.78      0.71    531841

    accuracy                           0.68   1063682
   macro avg       0.69      0.68      0.68   1063682
weighted avg       0.69      0.68      0.68   1063682

Confusion Matrix:
[[315036 216805]
 [119099 412742]]
evaluated
--------------------------------------------------
